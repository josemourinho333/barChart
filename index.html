<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pyoo Bar Chart</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
  <header>
    <h1>Premier League's Current Top Scorers vs Most Goals Scored In a Season</h1>
    <h4>2022 - 2023</h4>
  </header>

  <div class="settings-button-area">
    <button class="submit-button confirmation-buttons">Submit</button>
    <button class="create-button navigation-buttons">Create</button>
    <button class="add-button navigation-buttons">Add</button>
    <button class="edit-button navigation-buttons">Edit</button>
    <button id='cancel-button' class="cancel-button confirmation-buttons">Cancel</button>
    <button class="edit-bar-chart-button navigation-buttons">Edit Chart</button>
    <!-- <button class="edit-bar-settings-button navigation-buttons">Edit Settings</button> -->
  </div>

  <div class="settings-input-area">
    <div class="create-area-container input-areas">
      <div class="create-area-text">Names of each bar<br><span>(Separated by comma)</span></div>
      <textarea cols="30" rows="5" id="create-bar-labels">Mohamed Salah - 2017/18,Mohamed Salah,Son Heung-Min,Cristiano Ronaldo</textarea>
      <div class="create-area-text">Values of each bar<br><span>(Separated by comma)</span></div>
      <textarea id="create-bar-values" cols="30" rows="5">32,22,19,18</textarea>
      <div class="create-area-text">Bar category name for the labels</div>
      <textarea id="create-bar-category-name" cols="30" rows="5">Player Name</textarea>
      <div class="create-area-text">Set max legend and tick by amount<br><span>(Separated by comma)</span></div>
      <textarea id="create-bar-legends" cols="30" rows="5">35,5</textarea>
    </div>
    <div class="add-area-container input-areas">
      <input type="text" class="new-bar-label" placeholder="New Bar Label">
      <input type="number" class="new-bar-value" placeholder="New Bar Value">
      <input type="text" class="new-color-value" placeholder="Hexcode Color">
    </div>
    <div class="edit-area-container input-areas">
      <div class="edit-bar-chart">Change and upate the values in the bar chart</div>
      <textarea id="edit-space" cols="100" rows="5" class="edit-bar-chart"></textarea>
    </div>
    <div class="edit-settings-container input-areas">
      <div class="edit-bar-settings">Change and update the bar settings</div>
      <textarea id="edit-space-settings" cols="100" rows="5" class="edit-bar-settings"></textarea>
    </div>

  </div>

  <div id="container"></div>

  <script>
    // Navigation buttons handler
    const navigationButtons = (event) => {
      let buttonClass = event.target.className;
      if (buttonClass.includes('create-button')) {
        $('.create-button').hide();
        $('.add-button').hide();
        $('.edit-button').hide();
        $('.confirmation-buttons').show();
        $('.create-area-container').css('display','grid');
        $('.submit-button').removeAttr('id');
        $('.submit-button').attr('id', 'submit-create');
      } else if (buttonClass.includes('add-button')) {
        $('.create-button').hide();
        $('.add-button').hide();
        $('.edit-button').hide();
        $('.confirmation-buttons').show();
        $('.add-area-container').css('display','grid');
        $('.submit-button').removeAttr('id');
        $('.submit-button').attr('id', 'submit-add');
      } else if (buttonClass.includes('edit-button')) {
        $('.create-button').hide();
        $('.add-button').hide();
        $('.edit-button').hide();
        $('.cancel-button').show();
        $('.edit-bar-chart-button').show();
        $('.edit-bar-settings-button').show();
      } else if (buttonClass.includes('edit-bar-chart-button')) {
        $('.edit-bar-settings-button').hide();
        $('.confirmation-buttons').show();
        $('.edit-area-container').css('display','grid');
        editChart();
        $('.submit-button').removeAttr('id');
        $('.submit-button').attr('id', 'submit-edit-chart');
      } else if (buttonClass.includes('edit-bar-settings-button')) {
        $('.edit-bar-chart-button').hide();
        $('.confirmation-buttons').show();
        $('.edit-settings-container').css('display','grid');
        editSettings();
        $('.submit-button').removeAttr('id');
        $('.submit-button').attr('id', 'submit-edit-settings');
      }
    };

    // Confirmation buttons handler
    const confirmationButtons = (event) => {
      let buttonId = event.target.id;
      if (buttonId.includes('cancel-button')) {
        $('.create-button').show();
        $('.add-button').show();
        $('.edit-button').show();
        $('.edit-bar-chart-button').hide();
        $('.edit-bar-settings-button').hide();
        $('.confirmation-buttons').hide();
        $('.input-areas').hide();
        $('.submit-button').removeAttr('id');
      } else if (buttonId.includes('submit-create')) {
        drawBarChart();
        $('.create-button').show();
        $('.add-button').show();
        $('.edit-button').show();
        $('.edit-bar-chart-button').hide();
        $('.edit-bar-settings-button').hide();
        $('.confirmation-buttons').hide();
        $('.input-areas').hide();
        $('.submit-button').removeAttr('id');
      } else if (buttonId.includes('submit-add')) {
        addNewBar();
        $('.create-button').show();
        $('.add-button').show();
        $('.edit-button').show();
        $('.edit-bar-chart-button').hide();
        $('.edit-bar-settings-button').hide();
        $('.confirmation-buttons').hide();
        $('.input-areas').hide();
        $('.submit-button').removeAttr('id');
      } else if (buttonId.includes('submit-edit-chart')) {
        updateBar();
        $('.create-button').show();
        $('.add-button').show();
        $('.edit-button').show();
        $('.edit-bar-chart-button').hide();
        $('.edit-bar-settings-button').hide();
        $('.confirmation-buttons').hide();
        $('#edit-space').empty();
        $('.input-areas').hide();
        $('.submit-button').removeAttr('id');
      } else if (buttonId.includes('submit-edit-settings')) {
        updateBarSettings();
        $('.create-button').show();
        $('.add-button').show();
        $('.edit-button').show();
        $('.edit-bar-chart-button').hide();
        $('.edit-bar-settings-button').hide();
        $('.confirmation-buttons').hide();
        $('#edit-space-settings').empty();
        $('.input-areas').hide();
        $('.submit-button').removeAttr('id');
      }
    };

    // Function that will take inputs and generate a new chart and render it on the page
    const drawBarChart = (data, options, element) => {
      // Declaring variables and grabbing the inputs for the data that will be displayed in the chart then storing them as an array.
      let barNames = $('#create-bar-labels').text();
      let barNamesArray = barNames.split(',');
      let barValues = $('#create-bar-values').text();
      let barValuesArray = barValues.split(',');
      data = barNamesArray.concat(barValuesArray);

      // Declaring variables and grabbing the inputs for the chart settings storing them as an array.
      let barHeader = $('#create-bar-category-name').text();
      let barHeaderArray = [barHeader];
      let barLegends = $('#create-bar-legends').val();
      let barLegendsArray = barLegends.split(',');
      options = barHeaderArray.concat(barLegendsArray);

      // Declaring a variable where the chart will be rendered inside
      element = $('#container');

      // Called to make the bars and the bars names and append them into appropriate html structure with right classes with random colors.
      const barsOut = (data, options, element) => {
          let maxTick = options[1];
          for (let i = 0; i < data.length/2; i++) {
            let colorR = Math.floor((Math.random() * 256));
            let colorG = Math.floor((Math.random() * 256));
            let colorB = Math.floor((Math.random() * 256));
            let rgb = `${colorR}, ${colorG}, ${colorB}`;
            let realWidth = Math.floor((data[i+(data.length/2)]/maxTick)*100);

            let $gridContainer = $('<div/>', {class: 'grid-container'}),
                $gridName = $('<div/>', {class: 'name', text: data[i], style: 'background-color: rgb(' + rgb + ');'}),
                $gridValue = $('<div/>', {
                  class: 'value',
                  text: data[i+(data.length/2)],
                  style: 'width: ' + realWidth + '%;' + 'background-color: rgb(' + rgb + ');'});

            $gridContainer.append($gridName).appendTo(element);
            $gridContainer.append($gridValue).appendTo(element);
          }
        };

      // Called to make the bar header label and the ticks for the graph
      const setTicks = (options, element) => {
          let nameHeader = options[0];
          let maxTick = parseInt(options[1]);
          let minTick = parseInt(options[2]);
          let tickBy = parseInt(options[2]);
          let ticks = maxTick/tickBy;

          let $gridHeaderContainer = $('<div/>', {
                class: 'grid-header-container',
                style: 'grid-template-columns: 300px repeat(' + ticks + ', 1fr)'
              }),
              $nameHeader = $('<div/>', {class: 'name-header', text: nameHeader});

          $gridHeaderContainer.append($nameHeader).appendTo(element);

          for (let j = 0; j < ticks; j++) {
            let $valueHeader = $('<div/>', {class: 'value-header', text: (minTick += tickBy) - tickBy});
            $gridHeaderContainer.append($valueHeader).appendTo(element);
          }
        };

      setTicks(options, element);
      barsOut(data, options, element);
    };

    // Function that will take inputs and add a new bar in an existing chart
    const addNewBar = (name, value, color) => {
      name = $('.new-bar-label').val();
      value = parseInt($('.new-bar-value').val());
      color = $('.new-color-value').val();
      let maxTick = $('.value-header').last();
      let realWidth = Math.floor((value/maxTick.text())*100);

      let $gridContainer = $('<div/>', {class: 'grid-container'}),
          $gridName = $('<div/>', {class: 'name', text: name, style: 'background-color:' + color}),
          $gridValue = $('<div/>', {
            class: 'value',
            text: value,
            style: 'width:' + realWidth + '%' + ';' + 'background-color:' + color});

      $gridContainer.append($gridName).appendTo('#container');
      $gridContainer.append($gridValue).appendTo('#container');
    };

    // Function that will grab bar chart data and puts them in the text area
    const editChart = () => {
      const nameArray = [];
      const valueArray = [];
      const names = $('.name');
      const values = $('.value');
      for (let i = 0; i < names.length; i++) {
        nameArray.push(names[i].innerText);
      };

      for (let j = 0; j < values.length; j++) {
        valueArray.push(values[j].innerText);
      };

      $('#edit-space').text(nameArray + ',' + valueArray);
    };

    // Function that will update the chart after making changes in the textarea after editChart has been completed
    const updateBar = () => {
      $('.grid-container').remove();

      let changes = $('#edit-space').val();
      let changesArray = changes.split(',');
      let maxTick = $('.value-header').last();
      for (let i = 0; i < changesArray.length/2 ; i++) {
        let colorR = Math.floor((Math.random() * 256));
        let colorG = Math.floor((Math.random() * 256));
        let colorB = Math.floor((Math.random() * 256));
        let rgb = `${colorR}, ${colorG}, ${colorB}`;
        let realWidth = Math.floor((changesArray[i+(changesArray.length/2)]/maxTick.text())*100);

        let $gridContainer = $('<div/>', {class: 'grid-container'}),
            $gridName = $('<div/>', {class: 'name', text: changesArray[i], style: 'background-color: rgb(' + rgb + ');'}),
            $gridValue = $('<div/>', {
              class: 'value',
              text: changesArray[i+(changesArray.length/2)],
              style: 'width: ' + realWidth + '%;' + 'background-color: rgb(' + rgb + ');'});

        $gridContainer.append($gridName).appendTo($('#container'));
        $gridContainer.append($gridValue).appendTo($('#container'));
      }
    };

    // Function that will grab the bar chart settings and puts them in the text area
    const editSettings = (options) => {
      let header = $('.name-header').text();
      let maxTick = $('.value-header').last();
      let tickBy = $('.value-header').first();

      $('#edit-space-settings').text(`${header}, ${maxTick.text()}, ${tickBy.text()}`);
    };

    // Function that will update the chart settings after making changes in the textarea
    const updateBarSettings = () => {
      $('.grid-header-container').remove();

      let newSettings = $('#edit-space-settings').text();
      let newSettingsArray = newSettings.split(',');
      let nameHeader = newSettingsArray[0];
      let maxValue = parseInt(newSettingsArray[1]);
      let minValue = parseInt(newSettingsArray[2]);
      let tickBy = parseInt(newSettingsArray[2]);
      let ticks = maxValue/tickBy;

      let $gridHeaderContainer = $('<div/>', {
            class: 'grid-header-container',
            style: 'grid-template-columns: 300px repeat(' + ticks + ', 1fr)'
          }),
          $nameHeader = $('<div/>', {class: 'name-header', text: nameHeader});

      $gridHeaderContainer.append($nameHeader).prependTo('#container');

      for (let j = 0; j < ticks; j++) {
        let $valueHeader = $('<div/>', {class: 'value-header', text: (minValue += tickBy) - tickBy});
        $gridHeaderContainer.append($valueHeader).appendTo('#container');
      }
    };


    $('.navigation-buttons').click(navigationButtons);
    $('.confirmation-buttons').click(confirmationButtons);
  </script>
</body>
</html>
